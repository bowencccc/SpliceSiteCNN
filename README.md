# Splice Site Prediction

This project includes two main Python scripts:
- `model_train.py`: Trains a CNN model for splice site prediction using labeled sequence data.
- `score.py`: Applies the trained model to score splice junctions.

---

## Setup Instructions

### 1. Clone or Download the Project

```bash
git clone https://github.com/bowencccc/SpliceSiteCNN.git
cd SpliceSiteCNN
```

### 2. Install Dependencies

conda create -n splice_pred python=3.10 -y
conda activate splice_pred
pip install -r requirements.txt


## How to Run

### 1. Train the Model

### Example: Training the Model

Below is an example command to run the `model_train.py` script. It demonstrates how to supply all required input files and specify where to save the trained model:

```bash
python model_train.py \
  --reliable_junctions ./drosophila/GCF_000001215.4_Release_6_plus_ISO1_MT_genomic.fna.reliable_junctions.bed \
  --out_junctions ./drosophila/out.junctions.bed \
  --reference_genome ./drosophila/GCF_000001215.4_Release_6_plus_ISO1_MT_genomic.fna \
  --stringtie_gtf ./drosophila/GCF_000001215.4_Release_6_plus_ISO1_MT_genomic.fna.gtf \
  --output_file trained_model.pth
```

What this command does:  
Launches model_train.py, which will read in known “reliable” splice junctions, reference genome sequences, and annotation data to train a CNN-based splice site predictor.  
After training, it saves the model weights to trained_model.pth so you can use them later for scoring new sequences.

Breakdown of each argument:  
--reliable_junctions ./drosophila/GCF_000001215.4_Release_6_plus_ISO1_MT_genomic.fna.reliable_junctions.bed  
Path to a BED file containing high‐confidence (reliable) splice junction coordinates.  
The script will extract positive (true) splice site examples from this file.  


--out_junctions ./drosophila/out.junctions.bed  
Path where the script writes its own intermediate junctions (e.g., predicted or filtered junctions).  
You can use this file for downstream inspection or debugging of how junction candidates were generated.  


--reference_genome ./drosophila/GCF_000001215.4_Release_6_plus_ISO1_MT_genomic.fna  
Path to the reference genome FASTA (.fna) used to fetch sequence context around each junction.  
The model requires a fixed-length window of nucleotides flanking each junction, which it reads from this genome file.  

--stringtie_gtf ./drosophila/GCF_000001215.4_Release_6_plus_ISO1_MT_genomic.fna.gtf  
Path to the GTF file generated by StringTie (or another assembler) containing transcript annotations.  
This file is used to locate exon/intron boundaries and generate negative examples (non‐splice sites) for training.  

--output_file trained_model.pth  
Filename (with .pth extension) where the trained PyTorch model weights will be saved.  
After the script finishes, you can pass this file to score.py (or a similar evaluation script) to score new sequences.  